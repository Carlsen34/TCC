{"dependencies":[{"name":"../core","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var AWS = _$$_REQUIRE(_dependencyMap[0], \"../core\");\n\n  AWS.util.update(AWS.SQS.prototype, {\n    setupRequestListeners: function setupRequestListeners(request) {\n      request.addListener('build', this.buildEndpoint);\n\n      if (request.service.config.computeChecksums) {\n        if (request.operation === 'sendMessage') {\n          request.addListener('extractData', this.verifySendMessageChecksum);\n        } else if (request.operation === 'sendMessageBatch') {\n          request.addListener('extractData', this.verifySendMessageBatchChecksum);\n        } else if (request.operation === 'receiveMessage') {\n          request.addListener('extractData', this.verifyReceiveMessageChecksum);\n        }\n      }\n    },\n    verifySendMessageChecksum: function verifySendMessageChecksum(response) {\n      if (!response.data) return;\n      var md5 = response.data.MD5OfMessageBody;\n      var body = this.params.MessageBody;\n      var calculatedMd5 = this.service.calculateChecksum(body);\n\n      if (calculatedMd5 !== md5) {\n        var msg = 'Got \"' + response.data.MD5OfMessageBody + '\", expecting \"' + calculatedMd5 + '\".';\n        this.service.throwInvalidChecksumError(response, [response.data.MessageId], msg);\n      }\n    },\n    verifySendMessageBatchChecksum: function verifySendMessageBatchChecksum(response) {\n      if (!response.data) return;\n      var service = this.service;\n      var entries = {};\n      var errors = [];\n      var messageIds = [];\n      AWS.util.arrayEach(response.data.Successful, function (entry) {\n        entries[entry.Id] = entry;\n      });\n      AWS.util.arrayEach(this.params.Entries, function (entry) {\n        if (entries[entry.Id]) {\n          var md5 = entries[entry.Id].MD5OfMessageBody;\n          var body = entry.MessageBody;\n\n          if (!service.isChecksumValid(md5, body)) {\n            errors.push(entry.Id);\n            messageIds.push(entries[entry.Id].MessageId);\n          }\n        }\n      });\n\n      if (errors.length > 0) {\n        service.throwInvalidChecksumError(response, messageIds, 'Invalid messages: ' + errors.join(', '));\n      }\n    },\n    verifyReceiveMessageChecksum: function verifyReceiveMessageChecksum(response) {\n      if (!response.data) return;\n      var service = this.service;\n      var messageIds = [];\n      AWS.util.arrayEach(response.data.Messages, function (message) {\n        var md5 = message.MD5OfBody;\n        var body = message.Body;\n\n        if (!service.isChecksumValid(md5, body)) {\n          messageIds.push(message.MessageId);\n        }\n      });\n\n      if (messageIds.length > 0) {\n        service.throwInvalidChecksumError(response, messageIds, 'Invalid messages: ' + messageIds.join(', '));\n      }\n    },\n    throwInvalidChecksumError: function throwInvalidChecksumError(response, ids, message) {\n      response.error = AWS.util.error(new Error(), {\n        retryable: true,\n        code: 'InvalidChecksum',\n        messageIds: ids,\n        message: response.request.operation + ' returned an invalid MD5 response. ' + message\n      });\n    },\n    isChecksumValid: function isChecksumValid(checksum, data) {\n      return this.calculateChecksum(data) === checksum;\n    },\n    calculateChecksum: function calculateChecksum(data) {\n      return AWS.util.crypto.md5(data, 'hex');\n    },\n    buildEndpoint: function buildEndpoint(request) {\n      var url = request.httpRequest.params.QueueUrl;\n\n      if (url) {\n        request.httpRequest.endpoint = new AWS.Endpoint(url);\n        var matches = request.httpRequest.endpoint.host.match(/^sqs\\.(.+?)\\./);\n        if (matches) request.httpRequest.region = matches[1];\n      }\n    }\n  });\n});","map":[[2,0,1,0],[2,6,1,4,"AWS"],[2,9,1,7],[2,12,1,10,"require"],[2,23,1,17],[2,53,1,0],[4,0,3,0,"AWS"],[4,2,3,0,"AWS"],[4,5,3,3],[4,6,3,4,"util"],[4,10,3,0],[4,11,3,9,"update"],[4,17,3,0],[4,18,3,16,"AWS"],[4,21,3,19],[4,22,3,20,"SQS"],[4,25,3,16],[4,26,3,24,"prototype"],[4,35,3,0],[4,37,3,35],[5,0,7,2,"setupRequestListeners"],[5,4,7,2,"setupRequestListeners"],[5,25,7,23],[5,27,7,25],[5,36,7,34,"setupRequestListeners"],[5,57,7,25],[5,58,7,56,"request"],[5,65,7,25],[5,67,7,65],[6,0,8,4,"request"],[6,6,8,4,"request"],[6,13,8,11],[6,14,8,12,"addListener"],[6,25,8,4],[6,26,8,24],[6,33,8,4],[6,35,8,33],[6,40,8,38,"buildEndpoint"],[6,53,8,4],[8,0,10,4],[8,10,10,8,"request"],[8,17,10,15],[8,18,10,16,"service"],[8,25,10,8],[8,26,10,24,"config"],[8,32,10,8],[8,33,10,31,"computeChecksums"],[8,49,10,4],[8,51,10,49],[9,0,11,6],[9,12,11,10,"request"],[9,19,11,17],[9,20,11,18,"operation"],[9,29,11,10],[9,34,11,32],[9,47,11,6],[9,49,11,47],[10,0,12,8,"request"],[10,10,12,8,"request"],[10,17,12,15],[10,18,12,16,"addListener"],[10,29,12,8],[10,30,12,28],[10,43,12,8],[10,45,12,43],[10,50,12,48,"verifySendMessageChecksum"],[10,75,12,8],[11,0,13,7],[11,9,11,6],[11,15,13,13],[11,19,13,17,"request"],[11,26,13,24],[11,27,13,25,"operation"],[11,36,13,17],[11,41,13,39],[11,59,13,13],[11,61,13,59],[12,0,14,8,"request"],[12,10,14,8,"request"],[12,17,14,15],[12,18,14,16,"addListener"],[12,29,14,8],[12,30,14,28],[12,43,14,8],[12,45,14,43],[12,50,14,48,"verifySendMessageBatchChecksum"],[12,80,14,8],[13,0,15,7],[13,9,13,13],[13,15,15,13],[13,19,15,17,"request"],[13,26,15,24],[13,27,15,25,"operation"],[13,36,15,17],[13,41,15,39],[13,57,15,13],[13,59,15,57],[14,0,16,8,"request"],[14,10,16,8,"request"],[14,17,16,15],[14,18,16,16,"addListener"],[14,29,16,8],[14,30,16,28],[14,43,16,8],[14,45,16,43],[14,50,16,48,"verifyReceiveMessageChecksum"],[14,78,16,8],[15,0,17,7],[16,0,18,5],[17,0,19,3],[17,5,3,35],[18,0,24,2,"verifySendMessageChecksum"],[18,4,24,2,"verifySendMessageChecksum"],[18,29,24,27],[18,31,24,29],[18,40,24,38,"verifySendMessageChecksum"],[18,65,24,29],[18,66,24,64,"response"],[18,74,24,29],[18,76,24,74],[19,0,25,4],[19,10,25,8],[19,11,25,9,"response"],[19,19,25,17],[19,20,25,18,"data"],[19,24,25,4],[19,26,25,24],[20,0,27,4],[20,10,27,8,"md5"],[20,13,27,11],[20,16,27,14,"response"],[20,24,27,22],[20,25,27,23,"data"],[20,29,27,14],[20,30,27,28,"MD5OfMessageBody"],[20,46,27,4],[21,0,28,4],[21,10,28,8,"body"],[21,14,28,12],[21,17,28,15],[21,22,28,20,"params"],[21,28,28,15],[21,29,28,27,"MessageBody"],[21,40,28,4],[22,0,29,4],[22,10,29,8,"calculatedMd5"],[22,23,29,21],[22,26,29,24],[22,31,29,29,"service"],[22,38,29,24],[22,39,29,37,"calculateChecksum"],[22,56,29,24],[22,57,29,55,"body"],[22,61,29,24],[22,62,29,4],[24,0,30,4],[24,10,30,8,"calculatedMd5"],[24,23,30,21],[24,28,30,26,"md5"],[24,31,30,4],[24,33,30,31],[25,0,31,6],[25,12,31,10,"msg"],[25,15,31,13],[25,18,31,16],[25,28,31,26,"response"],[25,36,31,34],[25,37,31,35,"data"],[25,41,31,26],[25,42,31,40,"MD5OfMessageBody"],[25,58,31,16],[25,61,32,8],[25,77,31,16],[25,80,32,27,"calculatedMd5"],[25,93,31,16],[25,96,32,43],[25,100,31,6],[26,0,33,6],[26,13,33,11,"service"],[26,20,33,6],[26,21,33,19,"throwInvalidChecksumError"],[26,46,33,6],[26,47,33,45,"response"],[26,55,33,6],[26,57,34,8],[26,58,34,9,"response"],[26,66,34,17],[26,67,34,18,"data"],[26,71,34,9],[26,72,34,23,"MessageId"],[26,81,34,8],[26,82,33,6],[26,84,34,35,"msg"],[26,87,33,6],[27,0,35,5],[28,0,36,3],[28,5,3,35],[29,0,41,2,"verifySendMessageBatchChecksum"],[29,4,41,2,"verifySendMessageBatchChecksum"],[29,34,41,32],[29,36,41,34],[29,45,41,43,"verifySendMessageBatchChecksum"],[29,75,41,34],[29,76,41,74,"response"],[29,84,41,34],[29,86,41,84],[30,0,42,4],[30,10,42,8],[30,11,42,9,"response"],[30,19,42,17],[30,20,42,18,"data"],[30,24,42,4],[30,26,42,24],[31,0,44,4],[31,10,44,8,"service"],[31,17,44,15],[31,20,44,18],[31,25,44,23,"service"],[31,32,44,4],[32,0,45,4],[32,10,45,8,"entries"],[32,17,45,15],[32,20,45,18],[32,22,45,4],[33,0,46,4],[33,10,46,8,"errors"],[33,16,46,14],[33,19,46,17],[33,21,46,4],[34,0,47,4],[34,10,47,8,"messageIds"],[34,20,47,18],[34,23,47,21],[34,25,47,4],[35,0,48,4,"AWS"],[35,6,48,4,"AWS"],[35,9,48,7],[35,10,48,8,"util"],[35,14,48,4],[35,15,48,13,"arrayEach"],[35,24,48,4],[35,25,48,23,"response"],[35,33,48,31],[35,34,48,32,"data"],[35,38,48,23],[35,39,48,37,"Successful"],[35,49,48,4],[35,51,48,49],[35,61,48,59,"entry"],[35,66,48,49],[35,68,48,66],[36,0,49,6,"entries"],[36,8,49,6,"entries"],[36,15,49,13],[36,16,49,14,"entry"],[36,21,49,19],[36,22,49,20,"Id"],[36,24,49,13],[36,25,49,6],[36,28,49,26,"entry"],[36,33,49,6],[37,0,50,5],[37,7,48,4],[38,0,51,4,"AWS"],[38,6,51,4,"AWS"],[38,9,51,7],[38,10,51,8,"util"],[38,14,51,4],[38,15,51,13,"arrayEach"],[38,24,51,4],[38,25,51,23],[38,30,51,28,"params"],[38,36,51,23],[38,37,51,35,"Entries"],[38,44,51,4],[38,46,51,44],[38,56,51,54,"entry"],[38,61,51,44],[38,63,51,61],[39,0,52,6],[39,12,52,10,"entries"],[39,19,52,17],[39,20,52,18,"entry"],[39,25,52,23],[39,26,52,24,"Id"],[39,28,52,17],[39,29,52,6],[39,31,52,29],[40,0,53,8],[40,14,53,12,"md5"],[40,17,53,15],[40,20,53,18,"entries"],[40,27,53,25],[40,28,53,26,"entry"],[40,33,53,31],[40,34,53,32,"Id"],[40,36,53,25],[40,37,53,18],[40,38,53,36,"MD5OfMessageBody"],[40,54,53,8],[41,0,54,8],[41,14,54,12,"body"],[41,18,54,16],[41,21,54,19,"entry"],[41,26,54,24],[41,27,54,25,"MessageBody"],[41,38,54,8],[43,0,55,8],[43,14,55,12],[43,15,55,13,"service"],[43,22,55,20],[43,23,55,21,"isChecksumValid"],[43,38,55,13],[43,39,55,37,"md5"],[43,42,55,13],[43,44,55,42,"body"],[43,48,55,13],[43,49,55,8],[43,51,55,49],[44,0,56,10,"errors"],[44,12,56,10,"errors"],[44,18,56,16],[44,19,56,17,"push"],[44,23,56,10],[44,24,56,22,"entry"],[44,29,56,27],[44,30,56,28,"Id"],[44,32,56,10],[45,0,57,10,"messageIds"],[45,12,57,10,"messageIds"],[45,22,57,20],[45,23,57,21,"push"],[45,27,57,10],[45,28,57,26,"entries"],[45,35,57,33],[45,36,57,34,"entry"],[45,41,57,39],[45,42,57,40,"Id"],[45,44,57,33],[45,45,57,26],[45,46,57,44,"MessageId"],[45,55,57,10],[46,0,58,9],[47,0,59,7],[48,0,60,5],[48,7,51,4],[50,0,62,4],[50,10,62,8,"errors"],[50,16,62,14],[50,17,62,15,"length"],[50,23,62,8],[50,26,62,24],[50,27,62,4],[50,29,62,27],[51,0,63,6,"service"],[51,8,63,6,"service"],[51,15,63,13],[51,16,63,14,"throwInvalidChecksumError"],[51,41,63,6],[51,42,63,40,"response"],[51,50,63,6],[51,52,63,50,"messageIds"],[51,62,63,6],[51,64,64,8],[51,87,64,31,"errors"],[51,93,64,37],[51,94,64,38,"join"],[51,98,64,31],[51,99,64,43],[51,103,64,31],[51,104,63,6],[52,0,65,5],[53,0,66,3],[53,5,3,35],[54,0,71,2,"verifyReceiveMessageChecksum"],[54,4,71,2,"verifyReceiveMessageChecksum"],[54,32,71,30],[54,34,71,32],[54,43,71,41,"verifyReceiveMessageChecksum"],[54,71,71,32],[54,72,71,70,"response"],[54,80,71,32],[54,82,71,80],[55,0,72,4],[55,10,72,8],[55,11,72,9,"response"],[55,19,72,17],[55,20,72,18,"data"],[55,24,72,4],[55,26,72,24],[56,0,74,4],[56,10,74,8,"service"],[56,17,74,15],[56,20,74,18],[56,25,74,23,"service"],[56,32,74,4],[57,0,75,4],[57,10,75,8,"messageIds"],[57,20,75,18],[57,23,75,21],[57,25,75,4],[58,0,76,4,"AWS"],[58,6,76,4,"AWS"],[58,9,76,7],[58,10,76,8,"util"],[58,14,76,4],[58,15,76,13,"arrayEach"],[58,24,76,4],[58,25,76,23,"response"],[58,33,76,31],[58,34,76,32,"data"],[58,38,76,23],[58,39,76,37,"Messages"],[58,47,76,4],[58,49,76,47],[58,59,76,56,"message"],[58,66,76,47],[58,68,76,65],[59,0,77,6],[59,12,77,10,"md5"],[59,15,77,13],[59,18,77,16,"message"],[59,25,77,23],[59,26,77,24,"MD5OfBody"],[59,35,77,6],[60,0,78,6],[60,12,78,10,"body"],[60,16,78,14],[60,19,78,17,"message"],[60,26,78,24],[60,27,78,25,"Body"],[60,31,78,6],[62,0,79,6],[62,12,79,10],[62,13,79,11,"service"],[62,20,79,18],[62,21,79,19,"isChecksumValid"],[62,36,79,11],[62,37,79,35,"md5"],[62,40,79,11],[62,42,79,40,"body"],[62,46,79,11],[62,47,79,6],[62,49,79,47],[63,0,80,8,"messageIds"],[63,10,80,8,"messageIds"],[63,20,80,18],[63,21,80,19,"push"],[63,25,80,8],[63,26,80,24,"message"],[63,33,80,31],[63,34,80,32,"MessageId"],[63,43,80,8],[64,0,81,7],[65,0,82,5],[65,7,76,4],[67,0,84,4],[67,10,84,8,"messageIds"],[67,20,84,18],[67,21,84,19,"length"],[67,27,84,8],[67,30,84,28],[67,31,84,4],[67,33,84,31],[68,0,85,6,"service"],[68,8,85,6,"service"],[68,15,85,13],[68,16,85,14,"throwInvalidChecksumError"],[68,41,85,6],[68,42,85,40,"response"],[68,50,85,6],[68,52,85,50,"messageIds"],[68,62,85,6],[68,64,86,8],[68,87,86,31,"messageIds"],[68,97,86,41],[68,98,86,42,"join"],[68,102,86,31],[68,103,86,47],[68,107,86,31],[68,108,85,6],[69,0,87,5],[70,0,88,3],[70,5,3,35],[71,0,93,2,"throwInvalidChecksumError"],[71,4,93,2,"throwInvalidChecksumError"],[71,29,93,27],[71,31,93,29],[71,40,93,38,"throwInvalidChecksumError"],[71,65,93,29],[71,66,93,64,"response"],[71,74,93,29],[71,76,93,74,"ids"],[71,79,93,29],[71,81,93,79,"message"],[71,88,93,29],[71,90,93,88],[72,0,94,4,"response"],[72,6,94,4,"response"],[72,14,94,12],[72,15,94,13,"error"],[72,20,94,4],[72,23,94,21,"AWS"],[72,26,94,24],[72,27,94,25,"util"],[72,31,94,21],[72,32,94,30,"error"],[72,37,94,21],[72,38,94,36],[72,42,94,40,"Error"],[72,47,94,36],[72,49,94,21],[72,51,94,49],[73,0,95,6,"retryable"],[73,8,95,6,"retryable"],[73,17,95,15],[73,19,95,17],[73,23,94,49],[74,0,96,6,"code"],[74,8,96,6,"code"],[74,12,96,10],[74,14,96,12],[74,31,94,49],[75,0,97,6,"messageIds"],[75,8,97,6,"messageIds"],[75,18,97,16],[75,20,97,18,"ids"],[75,23,94,49],[76,0,98,6,"message"],[76,8,98,6,"message"],[76,15,98,13],[76,17,98,15,"response"],[76,25,98,23],[76,26,98,24,"request"],[76,33,98,15],[76,34,98,32,"operation"],[76,43,98,15],[76,46,99,15],[76,83,98,15],[76,86,99,55,"message"],[77,0,94,49],[77,7,94,21],[77,8,94,4],[78,0,101,3],[78,5,3,35],[79,0,106,2,"isChecksumValid"],[79,4,106,2,"isChecksumValid"],[79,19,106,17],[79,21,106,19],[79,30,106,28,"isChecksumValid"],[79,45,106,19],[79,46,106,44,"checksum"],[79,54,106,19],[79,56,106,54,"data"],[79,60,106,19],[79,62,106,60],[80,0,107,4],[80,13,107,11],[80,18,107,16,"calculateChecksum"],[80,35,107,11],[80,36,107,34,"data"],[80,40,107,11],[80,46,107,44,"checksum"],[80,54,107,4],[81,0,108,3],[81,5,3,35],[82,0,113,2,"calculateChecksum"],[82,4,113,2,"calculateChecksum"],[82,21,113,19],[82,23,113,21],[82,32,113,30,"calculateChecksum"],[82,49,113,21],[82,50,113,48,"data"],[82,54,113,21],[82,56,113,54],[83,0,114,4],[83,13,114,11,"AWS"],[83,16,114,14],[83,17,114,15,"util"],[83,21,114,11],[83,22,114,20,"crypto"],[83,28,114,11],[83,29,114,27,"md5"],[83,32,114,11],[83,33,114,31,"data"],[83,37,114,11],[83,39,114,37],[83,44,114,11],[83,45,114,4],[84,0,115,3],[84,5,3,35],[85,0,120,2,"buildEndpoint"],[85,4,120,2,"buildEndpoint"],[85,17,120,15],[85,19,120,17],[85,28,120,26,"buildEndpoint"],[85,41,120,17],[85,42,120,40,"request"],[85,49,120,17],[85,51,120,49],[86,0,121,4],[86,10,121,8,"url"],[86,13,121,11],[86,16,121,14,"request"],[86,23,121,21],[86,24,121,22,"httpRequest"],[86,35,121,14],[86,36,121,34,"params"],[86,42,121,14],[86,43,121,41,"QueueUrl"],[86,51,121,4],[88,0,122,4],[88,10,122,8,"url"],[88,13,122,4],[88,15,122,13],[89,0,123,6,"request"],[89,8,123,6,"request"],[89,15,123,13],[89,16,123,14,"httpRequest"],[89,27,123,6],[89,28,123,26,"endpoint"],[89,36,123,6],[89,39,123,37],[89,43,123,41,"AWS"],[89,46,123,44],[89,47,123,45,"Endpoint"],[89,55,123,37],[89,56,123,54,"url"],[89,59,123,37],[89,60,123,6],[90,0,127,6],[90,12,127,10,"matches"],[90,19,127,17],[90,22,127,20,"request"],[90,29,127,27],[90,30,127,28,"httpRequest"],[90,41,127,20],[90,42,127,40,"endpoint"],[90,50,127,20],[90,51,127,49,"host"],[90,55,127,20],[90,56,127,54,"match"],[90,61,127,20],[90,62,127,60],[90,77,127,20],[90,78,127,6],[91,0,128,6],[91,12,128,10,"matches"],[91,19,128,6],[91,21,128,19,"request"],[91,28,128,26],[91,29,128,27,"httpRequest"],[91,40,128,19],[91,41,128,39,"region"],[91,47,128,19],[91,50,128,48,"matches"],[91,57,128,55],[91,58,128,56],[91,59,128,55],[91,60,128,19],[92,0,129,5],[93,0,130,3],[94,0,3,35],[94,3,3,0]]},"type":"js/module"}]}