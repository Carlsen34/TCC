{"dependencies":[{"name":"@babel/runtime/helpers/extends","data":{"isAsync":false}},{"name":"./Logger","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _extends = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/extends\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var Logger_1 = _$$_REQUIRE(_dependencyMap[1], \"./Logger\");\n\n  var logger = new Logger_1.ConsoleLogger('Hub');\n\n  var HubClass = function () {\n    function HubClass(name) {\n      this.bus = [];\n      this.listeners = {};\n      this.name = name;\n    }\n\n    HubClass.createHub = function (name) {\n      return new HubClass(name);\n    };\n\n    HubClass.prototype.dispatch = function (channel, payload, source) {\n      if (source === void 0) {\n        source = '';\n      }\n\n      var capsule = {\n        'channel': channel,\n        'payload': _extends({}, payload),\n        'source': source\n      };\n\n      try {\n        this.bus.push(capsule);\n        this.toListeners(capsule);\n      } catch (e) {\n        logger.warn('Hub dispatch error', e);\n      }\n    };\n\n    HubClass.prototype.listen = function (channel, listener, listenerName) {\n      if (listenerName === void 0) {\n        listenerName = 'noname';\n      }\n\n      logger.debug(listenerName + ' listening ' + channel);\n      var holder = this.listeners[channel];\n\n      if (!holder) {\n        holder = [];\n        this.listeners[channel] = holder;\n      }\n\n      holder.push({\n        'name': listenerName,\n        'listener': listener\n      });\n    };\n\n    HubClass.prototype.toListeners = function (capsule) {\n      var channel = capsule.channel,\n          payload = capsule.payload,\n          source = capsule.source;\n      var holder = this.listeners[channel];\n\n      if (!holder) {\n        return;\n      }\n\n      holder.forEach(function (listener) {\n        try {\n          listener.listener.onHubCapsule(capsule);\n        } catch (e) {\n          logger.warn('error dispatching ' + channel + ' event to ' + listener.name);\n        }\n      });\n      this.bus.pop();\n    };\n\n    return HubClass;\n  }();\n\n  exports.HubClass = HubClass;\n  var Hub = new HubClass('__default__');\n  exports.default = Hub;\n});","map":[[2,0,1,0],[6,0,14,0,"Object"],[6,2,14,0,"Object"],[6,8,14,6],[6,9,14,7,"defineProperty"],[6,23,14,0],[6,24,14,22,"exports"],[6,31,14,0],[6,33,14,31],[6,45,14,0],[6,47,14,45],[7,0,14,47,"value"],[7,4,14,47,"value"],[7,9,14,52],[7,11,14,54],[8,0,14,45],[8,3,14,0],[10,0,15,0],[10,6,15,4,"Logger_1"],[10,14,15,12],[10,17,15,15,"require"],[10,28,15,22],[10,59,15,0],[12,0,16,0],[12,6,16,4,"logger"],[12,12,16,10],[12,15,16,13],[12,19,16,17,"Logger_1"],[12,27,16,25],[12,28,16,26,"ConsoleLogger"],[12,41,16,13],[12,42,16,40],[12,47,16,13],[12,48,16,0],[14,0,17,0],[14,6,17,4,"HubClass"],[14,14,17,12],[14,17,17,30],[14,29,17,42],[15,0,18,4],[15,13,18,13,"HubClass"],[15,21,18,4],[15,22,18,22,"name"],[15,26,18,4],[15,28,18,28],[16,0,19,8],[16,11,19,13,"bus"],[16,14,19,8],[16,17,19,19],[16,19,19,8],[17,0,20,8],[17,11,20,13,"listeners"],[17,20,20,8],[17,23,20,25],[17,25,20,8],[18,0,21,8],[18,11,21,13,"name"],[18,15,21,8],[18,18,21,20,"name"],[18,22,21,8],[19,0,22,5],[21,0,23,4,"HubClass"],[21,4,23,4,"HubClass"],[21,12,23,12],[21,13,23,13,"createHub"],[21,22,23,4],[21,25,23,25],[21,35,23,35,"name"],[21,39,23,25],[21,41,23,41],[22,0,24,8],[22,13,24,15],[22,17,24,19,"HubClass"],[22,25,24,15],[22,26,24,28,"name"],[22,30,24,15],[22,31,24,8],[23,0,25,5],[23,5,23,4],[25,0,26,4,"HubClass"],[25,4,26,4,"HubClass"],[25,12,26,12],[25,13,26,13,"prototype"],[25,22,26,4],[25,23,26,23,"dispatch"],[25,31,26,4],[25,34,26,34],[25,44,26,44,"channel"],[25,51,26,34],[25,53,26,53,"payload"],[25,60,26,34],[25,62,26,62,"source"],[25,68,26,34],[25,70,26,70],[26,0,27,8],[26,10,27,12,"source"],[26,16,27,18],[26,21,27,23],[26,26,27,28],[26,27,27,8],[26,29,27,31],[27,0,27,33,"source"],[27,8,27,33,"source"],[27,14,27,39],[27,17,27,42],[27,19,27,33],[28,0,27,47],[30,0,28,8],[30,10,28,12,"capsule"],[30,17,28,19],[30,20,28,22],[31,0,29,12],[31,19,29,23,"channel"],[31,26,28,22],[32,0,30,12],[32,19,30,23],[32,28,30,37],[32,30,30,23],[32,32,30,41,"payload"],[32,39,30,23],[32,40,28,22],[33,0,31,12],[33,18,31,22,"source"],[34,0,28,22],[34,7,28,8],[36,0,33,8],[36,10,33,12],[37,0,34,12],[37,13,34,17,"bus"],[37,16,34,12],[37,17,34,21,"push"],[37,21,34,12],[37,22,34,26,"capsule"],[37,29,34,12],[38,0,35,12],[38,13,35,17,"toListeners"],[38,24,35,12],[38,25,35,29,"capsule"],[38,32,35,12],[39,0,36,9],[39,7,33,8],[39,8,37,8],[39,15,37,15,"e"],[39,16,37,8],[39,18,37,18],[40,0,38,12,"logger"],[40,8,38,12,"logger"],[40,14,38,18],[40,15,38,19,"warn"],[40,19,38,12],[40,20,38,24],[40,40,38,12],[40,42,38,46,"e"],[40,43,38,12],[41,0,39,9],[42,0,40,5],[42,5,26,4],[44,0,41,4,"HubClass"],[44,4,41,4,"HubClass"],[44,12,41,12],[44,13,41,13,"prototype"],[44,22,41,4],[44,23,41,23,"listen"],[44,29,41,4],[44,32,41,32],[44,42,41,42,"channel"],[44,49,41,32],[44,51,41,51,"listener"],[44,59,41,32],[44,61,41,61,"listenerName"],[44,73,41,32],[44,75,41,75],[45,0,42,8],[45,10,42,12,"listenerName"],[45,22,42,24],[45,27,42,29],[45,32,42,34],[45,33,42,8],[45,35,42,37],[46,0,42,39,"listenerName"],[46,8,42,39,"listenerName"],[46,20,42,51],[46,23,42,54],[46,31,42,39],[47,0,42,65],[49,0,43,8,"logger"],[49,6,43,8,"logger"],[49,12,43,14],[49,13,43,15,"debug"],[49,18,43,8],[49,19,43,21,"listenerName"],[49,31,43,33],[49,34,43,36],[49,47,43,21],[49,50,43,52,"channel"],[49,57,43,8],[50,0,44,8],[50,10,44,12,"holder"],[50,16,44,18],[50,19,44,21],[50,24,44,26,"listeners"],[50,33,44,21],[50,34,44,36,"channel"],[50,41,44,21],[50,42,44,8],[52,0,45,8],[52,10,45,12],[52,11,45,13,"holder"],[52,17,45,8],[52,19,45,21],[53,0,46,12,"holder"],[53,8,46,12,"holder"],[53,14,46,18],[53,17,46,21],[53,19,46,12],[54,0,47,12],[54,13,47,17,"listeners"],[54,22,47,12],[54,23,47,27,"channel"],[54,30,47,12],[54,34,47,38,"holder"],[54,40,47,12],[55,0,48,9],[57,0,49,8,"holder"],[57,6,49,8,"holder"],[57,12,49,14],[57,13,49,15,"push"],[57,17,49,8],[57,18,49,20],[58,0,50,12],[58,16,50,20,"listenerName"],[58,28,49,20],[59,0,51,12],[59,20,51,24,"listener"],[60,0,49,20],[60,7,49,8],[61,0,53,5],[61,5,41,4],[63,0,54,4,"HubClass"],[63,4,54,4,"HubClass"],[63,12,54,12],[63,13,54,13,"prototype"],[63,22,54,4],[63,23,54,23,"toListeners"],[63,34,54,4],[63,37,54,37],[63,47,54,47,"capsule"],[63,54,54,37],[63,56,54,56],[64,0,55,8],[64,10,55,12,"channel"],[64,17,55,19],[64,20,55,22,"capsule"],[64,27,55,29],[64,28,55,30,"channel"],[64,35,55,8],[65,0,55,8],[65,10,55,39,"payload"],[65,17,55,46],[65,20,55,49,"capsule"],[65,27,55,56],[65,28,55,57,"payload"],[65,35,55,8],[66,0,55,8],[66,10,55,66,"source"],[66,16,55,72],[66,19,55,75,"capsule"],[66,26,55,82],[66,27,55,83,"source"],[66,33,55,8],[67,0,56,8],[67,10,56,12,"holder"],[67,16,56,18],[67,19,56,21],[67,24,56,26,"listeners"],[67,33,56,21],[67,34,56,36,"channel"],[67,41,56,21],[67,42,56,8],[69,0,57,8],[69,10,57,12],[69,11,57,13,"holder"],[69,17,57,8],[69,19,57,21],[70,0,58,12],[71,0,59,9],[73,0,60,8,"holder"],[73,6,60,8,"holder"],[73,12,60,14],[73,13,60,15,"forEach"],[73,20,60,8],[73,21,60,23],[73,31,60,33,"listener"],[73,39,60,23],[73,41,60,43],[74,0,61,12],[74,12,61,16],[75,0,62,16,"listener"],[75,10,62,16,"listener"],[75,18,62,24],[75,19,62,25,"listener"],[75,27,62,16],[75,28,62,34,"onHubCapsule"],[75,40,62,16],[75,41,62,47,"capsule"],[75,48,62,16],[76,0,63,13],[76,9,61,12],[76,10,64,12],[76,17,64,19,"e"],[76,18,64,12],[76,20,64,22],[77,0,65,16,"logger"],[77,10,65,16,"logger"],[77,16,65,22],[77,17,65,23,"warn"],[77,21,65,16],[77,22,65,28],[77,45,65,51,"channel"],[77,52,65,28],[77,55,65,61],[77,67,65,28],[77,70,65,76,"listener"],[77,78,65,84],[77,79,65,85,"name"],[77,83,65,16],[78,0,66,13],[79,0,67,9],[79,7,60,8],[80,0,68,8],[80,11,68,13,"bus"],[80,14,68,8],[80,15,68,17,"pop"],[80,18,68,8],[81,0,69,5],[81,5,54,4],[83,0,70,4],[83,11,70,11,"HubClass"],[83,19,70,4],[84,0,71,1],[84,3,17,30],[84,5,17,0],[86,0,72,0,"exports"],[86,2,72,0,"exports"],[86,9,72,7],[86,10,72,8,"HubClass"],[86,18,72,0],[86,21,72,19,"HubClass"],[86,29,72,0],[87,0,73,0],[87,6,73,4,"Hub"],[87,9,73,7],[87,12,73,10],[87,16,73,14,"HubClass"],[87,24,73,10],[87,25,73,23],[87,38,73,10],[87,39,73,0],[88,0,74,0,"exports"],[88,2,74,0,"exports"],[88,9,74,7],[88,10,74,8,"default"],[88,17,74,0],[88,20,74,18,"Hub"],[88,23,74,0]]},"type":"js/module"}]}